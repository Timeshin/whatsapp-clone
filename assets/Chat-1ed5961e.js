import{G as u,o as v,u as w,r as n,j as e,d as y,I as N,L as b,S as I}from"./index-3e424f74.js";import{C as L}from"./ContentLayout-207c9850.js";function S(s){return u({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M217.9 256L345 129c9.4-9.4 9.4-24.6 0-33.9-9.4-9.4-24.6-9.3-34 0L167 239c-9.1 9.1-9.3 23.7-.7 33.1L310.9 417c4.7 4.7 10.9 7 17 7s12.3-2.3 17-7c9.4-9.4 9.4-24.6 0-33.9L217.9 256z"}}]})(s)}function C(s){return u({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M48 448l416-192L48 64v149.333L346 256 48 298.667z"}}]})(s)}const M=()=>{const{chatStore:s,stepStore:d}=w(),[c,l]=n.useState(""),t=n.useRef(null),{messages:r,state:o,phoneNumber:x}=s,i=()=>{s.sendMessage(c),l("")},h=()=>{d.setStep(I.PhoneStep)},p=({target:a})=>{l(a.value)},f=({key:a})=>{a==="Enter"&&o.status!=="loading"&&i()};return n.useEffect(()=>{const a=setInterval(()=>{s.getMessage()},2e3);return()=>{clearInterval(a)}},[s]),n.useEffect(()=>{t.current&&t.current.scrollTop+t.current.clientHeight===t.current.scrollHeight-64&&(t.current.scrollTop=t.current.scrollHeight)},[r]),e.jsx(L,{children:e.jsx("div",{className:"w-[40vw]",children:e.jsxs("div",{className:"h-[70vh] flex flex-col justify-between",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"cursor-pointer",onClick:h,children:e.jsx(S,{size:24,color:"gray"})}),e.jsx("p",{className:"text-lg font-black",children:x})]}),e.jsx("div",{ref:t,className:"h-full overflow-y-auto p-4 flex flex-col",children:r==null?void 0:r.map(({id:a,isMine:g,text:m,timestamp:j})=>e.jsxs("div",{className:`break-all p-2 rounded-md mb-2 ${g?"bg-blue-500 text-white self-end":"bg-gray-300 text-black self-start"}`,children:[e.jsx("p",{children:m}),e.jsx("p",{className:"text-xs",children:y.unix(j).format("HH:mm")})]},a))}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(N,{onChange:p,value:c,onKeyDown:f,placeholder:"Type a message",name:"message"}),o.status==="loading"?e.jsx("span",{className:"w-[32px]",children:e.jsx(b,{})}):e.jsx("span",{onClick:i,className:"cursor-pointer",children:e.jsx(C,{size:30,color:"gray"})})]})]})})})},T=v(M);export{T as default};
